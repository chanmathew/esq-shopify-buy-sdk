{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/js/app.js","webpack:///./src/js/main.js","webpack:///./src/style/main.scss"],"names":["module","initCount","itemCount","slickInitCount","checkoutUpsellDisplayCount","lsCheckoutId","lsCartId","lsCheckoutUpsellDisplayCount","cartOpen","modalOpen","checkoutUpsellModalOpen","client","clientSettings","upsellSettings","upsellVariantId","$","fn","plugin","options","self","extend","domain","storefrontAccessToken","productHandle","defaultOption","defaultCurrency","defaultRegion","setup","createClient","fetchProduct","initPlugin","createContainer","createProduct","setDefaultOption","setDefaultColor","setSelectedText","createCart","createCartAndCheckoutId","createCartItems","attachListeners","ShopifyBuy","buildClient","hide","productOptions","data","append","singleVariant","createPrices","colorOptions","createOptions","createColors","optionsAndVariants","each","productOptionIndex","productOption","container","find","id","attr","firstVariant","variants","available","name","pricesContainer","filter","variant","optionsContainer","variantContainer","length","insertAfter","empty","index","swatchName","title","split","replace","toLowerCase","product","text","defaultOptionElement","availableVariants","reduce","acc","currentOption","push","matchFound","some","includes","element","i","el","availableColors","blackBrown","dataset","value","black","others","handleQuantity","on","e","target","css","qtySelector","siblings","val","oldValue","parseInt","handleCartQuantity","variantId","closest","qty","updateItems","selectedUnit","selectedColor","substring","toUpperCase","existingCheckoutId","JSON","parse","localStorage","getItem","checkout","fetch","then","lineItems","extractLineItems","catch","error","console","log","create","persistToLocalStorage","option","event","stopPropagation","stopImmediatePropagation","toggleCart","toggleModal","toggleCheckoutUpsellModal","addItems","removeItems","pluginUpsell","heading","headingColor","discountCode","discountType","discountAmount","upsellOnCheckout","cartUpsell","checkoutUpsells","upsellDisplayCount","fetchFromLocalStorage","firstImage","images","src","altText","descriptionHtml","galleryContainer","img","dropdown","modalContainer","productVariant","upsells","map","item","productContainer","priceContainer","recursiveArraySearch","selectedUpsell","addUpsellItem","trackFbEvent","addDiscountToCheckout","toggleClass","fadeToggle","slick","arrows","dots","key","valueJson","stringify","setItem","newLineItems","subtitle","setAddToCartLoading","boolean","not","show","setCheckoutLoading","formatPrices","formatToCurrency","variantPrices","presentmentPrices","results","price","currencyCode","compareAtPrice","formattedPrice","formattedComparePrice","priceFormatter","Intl","NumberFormat","style","currency","maximumSignificantDigits","amount","format","comparePrice","formattedPrices","numericPrices","variableValues","handle","isUpsellItem","comparePriceFormatted","discountPrice","discountPriceFormatted","getOptionValues","values","array","searchString","search","row","Object","keys","indexOf","html","fetchByHandle","response","unitOptions","bundleOptions","optionName","quantity","itemsToAdd","currentCheckoutId","addLineItems","toggleElement","selectedVariantId","selectedOption","addDiscount","cartItems","priceCount","image","totalCartQty","itemsToRemove","matchingVariant","removeLineItems","removeDiscount","itemsToUpdate","updateLineItems","webUrl","location","href","productTitle","pattern","productVariantShopifyId","exec","atob","fbq","priceV2","content_type","content_ids","content_category","content_name","num_items","jQuery"],"mappings":"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","file":"app.bundle.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","if (module.hot) {\n  module.hot.accept()\n}\nimport './main.js'\n","/* @license v0.1.8 Author: Mathew Chan. Copyright ESQIDO LTD. All Rights Reserved. */\n\n// Define variables\nlet initCount = 0\nlet itemCount = 0\nlet slickInitCount = 0\nlet checkoutUpsellDisplayCount = 0\nlet lsCheckoutId = 'esq_eyeliner_checkout_id'\nlet lsCartId = 'esq_eyeliner_cart'\nlet lsCheckoutUpsellDisplayCount = 'esq_checkout_upsell_display_count'\nlet cartOpen = false\nlet modalOpen = false\nlet checkoutUpsellModalOpen = false\nlet client\nlet clientSettings\nlet upsellSettings\nlet upsellVariantId\n\n  // Begin Plugin\n;(function ($) {\n  $.fn.plugin = async function (options) {\n    const self = this\n    clientSettings = $.extend(\n      {\n        domain: 'esqido.com',\n        storefrontAccessToken: '05f86644045cc5fc6cc10718814e3f31',\n        productHandle: 'gel-liner-pencil',\n        defaultOption: '2-Pack',\n        defaultCurrency: 'USD',\n        defaultRegion: 'en-US',\n      },\n      options\n    )\n    const setup = async function () {\n      createClient()\n      await fetchProduct(self, clientSettings.productHandle)\n    }\n    const initPlugin = async function () {\n      createContainer()\n      createProduct()\n      setDefaultOption()\n      setDefaultColor()\n      setSelectedText()\n      createCart()\n      await createCartAndCheckoutId()\n      createCartItems()\n      attachListeners()\n      initCount++\n    }\n    const createClient = function () {\n      const { domain, storefrontAccessToken } = clientSettings\n      client = ShopifyBuy.buildClient({\n        domain,\n        storefrontAccessToken,\n      })\n    }\n    const createContainer = function () {\n      $('.productSpinner').hide()\n      // If the product has options (not a single variant which only has an option of \"Title\")\n      const productOptions = self.data('productOptions')\n      if (productOptions) {\n        self.append(`\n          <div class=\"productOptions\"></div>\n          <div class=\"addToCartWrapper\">\n            <div class=\"quantity\">\n              <button class=\"quantity-button quantity-down\">-</button>\n                <input class=\"qtySelector\" type=\"number\" value=\"1\" min=\"1\" />\n              <button class=\"quantity-button quantity-up\">+</button>\n            </div>\n            <button class=\"btn addToCart\">\n              <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n              <span class=\"addToCartText\">Add To Cart</span>\n            </button>\n          </div>\n        `)\n      } else {\n        const singleVariant = self.data('singleVariant')\n        createPrices(singleVariant, self)\n        self.append(`\n          <span class=\"addToCartWrapper\">\n            <div class=\"quantity\">\n              <button class=\"quantity-button quantity-down\">-</button>\n                <input class=\"qtySelector\" type=\"number\" value=\"1\" min=\"1\" />\n              <button class=\"quantity-button quantity-up\">+</button>\n            </div>\n            <button class=\"btn addToCart\">\n              <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n              <span class=\"addToCartText\">Add To Cart</span>\n            </button>\n          </div>\n        `)\n      }\n    }\n    // Only render product options if the product has options or colors\n    const createProduct = function () {\n      const productOptions = self.data('productOptions')\n      const colorOptions = self.data('colorOptions')\n      if (productOptions) {\n        createOptions()\n      }\n      if (colorOptions) {\n        createColors(clientSettings.defaultOption)\n      }\n    }\n    // Render unit options\n    const createOptions = function () {\n      const optionsAndVariants = self.data('optionsAndVariants')\n      if (optionsAndVariants) {\n        $.each(optionsAndVariants, function (\n          productOptionIndex,\n          productOption\n        ) {\n          const container = self.find('.productOptions')\n          const id = self.attr('id')\n          const firstVariant = productOption.variants[0]\n          // First create the label and input for each product option\n          $(container).append(`\n            <label class=\"unit-option-label ${\n              !firstVariant.available ? 'unavailable' : ''\n            }\">\n              <input class=\"unit-option\" type=\"radio\" name=\"unit-option-${id}\" value='${\n            firstVariant.id\n          }' data-value='${productOption.name}' ${\n            !firstVariant.available ? 'disabled' : ''\n          }/>\n              ${productOption.name}\n            </label>\n          `)\n          // Get the price of any variant within that product option\n          const pricesContainer = container.find('.unit-option-label')[\n            productOptionIndex\n          ]\n          createPrices(firstVariant, pricesContainer, clientSettings)\n        })\n      }\n    }\n    const createColors = function (productOption) {\n      const optionsAndVariants = self.data('optionsAndVariants')\n      const colorOptions = self.data('colorOptions')\n      // Only render color swatches if it has color variants\n      if (colorOptions && productOption) {\n        // Find the variants for the matching option\n        const variants = optionsAndVariants.filter(\n          (variant) => variant.name === productOption\n        )[0]?.variants\n        // Append new container for productVariants\n        const optionsContainer = self.find('.productOptions')\n        const variantContainer = self.find('.productVariants')\n        if (!variantContainer.length) {\n          $(`\n            <div class=\"productVariants\"></div>\n            <p class=\"currentSelectedVariant\">\n              Selected: <span>Please choose an option</span>\n            </p>\n          `).insertAfter(optionsContainer)\n        }\n        let id = self.attr('id')\n        const container = self.find('.productVariants')\n        $(container).empty()\n        // Render color swatches\n        $.each(variants, function (index, variant) {\n          let swatchName = variant.title\n            .split(' / ')[1]\n            .replace(', ', '-')\n            .toLowerCase()\n          $(container).append(`\n          <label class=\"variant-option-label ${\n            !variant.available ? 'unavailable' : ''\n          }\" data-value=${swatchName}>\n              <input class=\"variant-option\" type=\"radio\" name=\"color-option-${id}\" data-value=${swatchName} value=${variant.id} ${!variant.available ? 'disabled' : ''}>\n          </label>\n        `)\n        })\n      }\n    }\n    const setDefaultOption = function () {\n      const singleVariant = self.data('singleVariant')\n      const product = self.data('product')\n      // Check if it's a single variant product, if it's sold out, disable the ATC button\n      if (singleVariant && !product.available) {\n        self.find('.addToCart').text('Sold Out').attr('disabled', true)\n      }\n      // Check if the product has options\n      const optionsAndVariants = self.data('optionsAndVariants')\n      if (optionsAndVariants) {\n        // Find the unit option that matches the defaultOption defined in settings\n        const defaultOptionElement = self.find(\n          `.unit-option[data-value='${clientSettings.defaultOption}']`\n        )\n        // Find all available variants\n        const availableVariants = optionsAndVariants.reduce(\n          (acc, currentOption) => {\n            // If the current variant is available\n            let variants = currentOption.variants.filter((variant) => {\n              return variant.available\n            })\n            if (variants.length) {\n              acc.push(...variants)\n            }\n            return acc\n          },\n          []\n        )\n        if (!availableVariants.length) {\n          self.find('.addToCart').text('Sold Out').attr('disabled', true)\n        }\n        // Find matching variantId in availableVariants array\n        const matchFound = availableVariants.some((variant) =>\n          variant.title.includes(clientSettings.defaultOption)\n        )\n        // If found, select the defaultOptionElement\n        if (matchFound) {\n          $(defaultOptionElement).attr('checked', true)\n        } else {\n          // Else, select another option element\n          const element = self.find('.unit-option')\n          $.each(element, function (i, el) {\n            if ($(el).data('value') !== clientSettings.defaultOption) {\n              $(el).attr('checked', true)\n            }\n          })\n        }\n      }\n    }\n    const setDefaultColor = function () {\n      // Check if there are colors that are available (in stock)\n      const availableColors = self.find('.variant-option:enabled')\n      if (availableColors.length) {\n        const blackBrown = availableColors.filter(\n          (i, el) => el.dataset.value === 'black-brown'\n        )\n        const black = availableColors.filter(\n          (i, el) => el.dataset.value === 'black'\n        )\n        const others = availableColors.filter((i, el) => {\n          return (\n            el.dataset.value !== 'black-brown' || el.dataset.value !== 'black'\n          )\n        })\n        if (blackBrown.length) {\n          return $(blackBrown[0]).attr('checked', true)\n        } else if (black.length) {\n          return $(black[0]).attr('checked', true)\n        } else {\n          return $(others[0]).attr('checked', true)\n        }\n      }\n    }\n    const handleQuantity = function () {\n      // Change background color of quantity buttons on click\n      $('body').on('mousedown', '.quantity-button', function (e) {\n        $(e.target).css('background-color', '#eee')\n      })\n      $('body').on('mouseup', '.quantity-button', function (e) {\n        $(e.target).css('background-color', '#fff')\n      })\n      // Increment or decrement the target quantity\n      self.on('click', '.quantity-down', function (e) {\n        let qtySelector = $(this).siblings('.qtySelector')\n        qtySelector.val(function (i, oldValue) {\n          if (oldValue > 1) {\n            return parseInt(oldValue, 10) - 1\n          } else {\n            return parseInt(oldValue, 10)\n          }\n        })\n      })\n      self.on('click', '.quantity-up', function () {\n        let qtySelector = $(this).siblings('.qtySelector')\n        qtySelector.val(function (i, oldValue) {\n          return parseInt(oldValue, 10) + 1\n        })\n      })\n    }\n    const handleCartQuantity = function () {\n      // Cart only needs event listeners once\n      if (initCount === 0) {\n        // Target cart quantity selectors\n        $('#cartLineItems').on('click', '.quantity-down', function (e) {\n          let qtySelector = $(this).siblings('.qtySelector')\n          qtySelector.val(function (i, oldValue) {\n            if (oldValue >= 1) {\n              return parseInt(oldValue, 10) - 1\n            } else {\n              return parseInt(oldValue, 10)\n            }\n          })\n          const variantId = $(this).closest('.cart-item').data().value\n          const qty = parseInt(qtySelector.val(), 10)\n          updateItems(variantId, qty)\n        })\n        $('#cartLineItems').on('click', '.quantity-up', function () {\n          let qtySelector = $(this).siblings('.qtySelector')\n          qtySelector.val(function (i, oldValue) {\n            return parseInt(oldValue, 10) + 1\n          })\n          const variantId = $(this).closest('.cart-item').data().value\n          const qty = parseInt(qtySelector.val(), 10)\n          updateItems(variantId, qty)\n        })\n      }\n    }\n    const setSelectedText = function () {\n      const colorOptions = self.data('colorOptions')\n      if (colorOptions?.length) {\n        const selectedUnit = self.find('.unit-option:checked').data('value')\n        let selectedColor = self.find('.variant-option:checked').data('value')\n        if (selectedColor === 'black-brown') {\n          selectedColor = '1 x Black, 1 x Brown'\n        } else {\n          selectedColor =\n            selectedColor.substring(0, 1).toUpperCase() +\n            selectedColor.substring(1, selectedColor.length)\n        }\n        self\n          .find('.currentSelectedVariant span')\n          .text(`${selectedUnit} - ${selectedColor}`)\n      }\n    }\n    /*\n      Cart Functions\n    */\n    const createCart = function () {\n      if (initCount === 0) {\n        $('#cartWrapper').empty().append(`\n          <div id=\"cartHeader\">\n            <h3>Your Bag</h3>\n            <button id=\"closeCart\">\n              <img src=\"https://uploads-ssl.webflow.com/5e70f8e5d7461820999a0cf5/5e7b70d9dd8fc24bf01bc3be_close.svg\" alt=\"Close Bag\" />\n            </button>\n          </div>\n          <div id=\"cartLineItems\">\n          </div>\n          <div id=\"cartEmpty\">\n              <p>Your bag's empty 🛍. Go shopping!</p>\n          </div>\n          <button id=\"checkoutButton\" class=\"btn\">\n            <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n            <span id=\"checkoutButtonText\">Checkout</span>\n          </button>\n        `)\n      }\n    }\n    const createCartAndCheckoutId = async function () {\n      if (initCount === 0) {\n        /* \n        IMPORANT: \n        Only 1 checkout is created for every instance on the same page / URL.\n        This ensures we can run multiple instances of this Jquery plugin to render multiple products on the same page with a unified cart\n      */\n        // Check if checkout exists in localstorage\n        const existingCheckoutId = JSON.parse(\n          localStorage.getItem(lsCheckoutId)\n        )\n        // If checkout exists, fetch checkout by checkoutId\n        if (existingCheckoutId) {\n          await client.checkout\n            .fetch(existingCheckoutId)\n            .then(function (checkout) {\n              if (checkout?.lineItems?.length) {\n                extractLineItems(checkout.lineItems)\n              }\n              createCartItems()\n            })\n            .catch((error) => {\n              console.log(\"Couldn't fetch checkout: \", error)\n            })\n        } else {\n          await client.checkout\n            .create()\n            .then(function (checkout) {\n              // Save new checkout ID to localstorage\n              if (checkout && checkout.id) {\n                persistToLocalStorage(lsCheckoutId, checkout.id)\n              }\n            })\n            .catch((error) =>\n              console.log(\"Couldn't create new checkout: \", error)\n            )\n        }\n      }\n    }\n    /*\n      Event Listeners \n    */\n    const attachListeners = function () {\n      const option = self.find('.unit-option')\n      $(option).on('click', function (e) {\n        createColors(e.target.dataset.value)\n        setDefaultColor()\n      })\n      // Do not attach listeners more than once\n      if (initCount === 0) {\n        // Render colors when unit options are changed\n        // Toggle cart drawer\n        $('body').on(\n          'click',\n          '#overlay, #openCart, .addToCart, #closeCart',\n          function (e) {\n            event.stopPropagation()\n            event.stopImmediatePropagation()\n            toggleCart()\n          }\n        )\n        $('body').on('click', '#modalOverlay', function (e) {\n          event.stopPropagation()\n          event.stopImmediatePropagation()\n          if (modalOpen) {\n            toggleModal()\n          } else if (checkoutUpsellModalOpen) {\n            toggleCheckoutUpsellModal()\n          }\n        })\n      }\n      // Add to cart handler\n      self.find('.addToCart').on('click', function (e) {\n        addItems(self, 'cart')\n      })\n      // Handle removing line items in cart\n      $('body').on('click', '.cart-item-remove', function (e) {\n        removeItems(e.target.dataset.value)\n      })\n      // Checkout handler\n      $('body').on('click', '#checkoutButton', async function (e) {\n        await checkout()\n      })\n      // Set selected text for Liner\n      self.on('click', '.unit-option, .variant-option', function (e) {\n        setSelectedText()\n      })\n      // Handle quantity inputs and buttons\n      handleQuantity()\n      handleCartQuantity()\n    }\n    // Call API and fetch product\n    await setup()\n    // Only render plugin if product exists\n    const product = self.data('product')\n    if (product) {\n      await initPlugin()\n    }\n  }\n  $.fn.pluginUpsell = async function (options) {\n    const self = this\n    upsellSettings = $.extend(\n      {\n        heading: 'You might also like',\n        headingColor: '#555555',\n        discountCode: null,\n        discountType: null,\n        discountAmount: null,\n        upsellOnCheckout: true,\n        cartUpsell: null,\n        checkoutUpsells: [\n          'unisyn-classic-bundle',\n          'unisyn-wispy-bundle',\n          'unisyn-glam-bundle',\n        ],\n      },\n      options\n    )\n    if (!client) {\n      console.log('Please initialize Client first.')\n    } else {\n      // Define the LS key for checkout upsell count\n      const upsellDisplayCount = fetchFromLocalStorage(\n        lsCheckoutUpsellDisplayCount\n      )\n      if (upsellSettings.upsellOnCheckout) {\n        if (upsellDisplayCount) {\n          checkoutUpsellDisplayCount = upsellDisplayCount\n        } else {\n          persistToLocalStorage(lsCheckoutUpsellDisplayCount, 0)\n        }\n      }\n      if (upsellSettings.cartUpsell) {\n        await fetchProduct(self, upsellSettings.cartUpsell)\n        const product = self.data('product')\n        if (product) {\n          const optionsAndVariants = self.data('optionsAndVariants')\n          const firstImage = product.images[0]\n          if (initCount === 0) {\n            $(self).append(`\n              <h3 class=\"cartUpsellTitle\" style=\"color: ${upsellSettings.headingColor}\">${upsellSettings.heading}</h3>\n            `)\n          }\n          $('#cartUpsells').append(`\n            <div class=\"upsellItem\">\n              <img class=\"upsellItemImage\" src=\"${firstImage.src}\" alt=\"${\n            firstImage.altText\n          }\">\n              <div class=\"upsellItemDetails\">\n                <a class=\"upsellItemTitle\">${product.title}</a>\n                ${\n                  optionsAndVariants\n                    ? `<select class=\"upsellProductOption\"></select>`\n                    : ''\n                }\n                <p class=\"upsellItemPrices\"></p>\n              </div>\n              <button class=\"btn upsellAddToCart\">\n                <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n                <span class=\"addToCartText\">Add</span>\n              </button>\n            </div>\n          `)\n          $('body').append(`\n            <div id=\"modalOverlay\"></div>\n            <div id=\"upsellItemModal\" class=\"upsellModal\">\n              <div id=\"upsellModalContainer\">\n                <div class=\"upsellItemGalleryContainer\">\n                  <div class=\"upsellItemGallery\"></div>\n                </div>\n                <div class=\"upsellItemDetails\">\n                  <a class=\"upsellItemTitle\">${product.title}</a>\n                  ${\n                    optionsAndVariants\n                      ? `<select class=\"upsellProductOption\"></select>`\n                      : ''\n                  }\n                  <p class=\"upsellItemPrices\"></p>\n                  <div class=\"upsellItemDescription\">${\n                    product.descriptionHtml\n                  }</div>\n                  <button class=\"btn upsellAddToCart\">\n                    <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n                    <span class=\"addToCartText\">Add To Cart</span>\n                  </button>\n                </div>\n                <button id=\"closeModal\">\n                  <img src=\"https://uploads-ssl.webflow.com/5e70f8e5d7461820999a0cf5/5e7b70d9dd8fc24bf01bc3be_close.svg\" alt=\"Close\" />\n                </button>\n              </div>\n            </div>\n          `)\n          const galleryContainer = $('#upsellItemModal').find(\n            '.upsellItemGallery'\n          )\n          $.each(product.images, function (i, img) {\n            $(galleryContainer).append(`\n            <img class=\"upsellItemImage\" src=\"${img.src}\" alt=\"${img.altText}\">\n            `)\n          })\n          if (optionsAndVariants) {\n            $.each(optionsAndVariants, function (\n              productOptionIndex,\n              productOption\n            ) {\n              const dropdown = $('body').find('.upsellProductOption')\n\n              const container = self.find('.upsellItem')\n              const id = self.attr('id')\n              const firstVariant = productOption.variants[0]\n              // First create the label and input for each product option\n              $(dropdown).append(`\n                <option class=\"unit-option\" value='${\n                  firstVariant.id\n                }' data-value='${productOption.name}' ${\n                !firstVariant.available ? 'disabled' : ''\n              }>\n                  ${productOption.name}\n                </option>\n              `)\n              // Get the price of any variant within that product option\n              const pricesContainer = container.find('.upsellItemPrices')[\n                productOptionIndex\n              ]\n              const modalContainer = $('#upsellItemModal').find(\n                '.upsellItemPrices'\n              )[productOptionIndex]\n              createPrices(firstVariant, pricesContainer)\n              createPrices(firstVariant, modalContainer)\n            })\n          } else {\n            const productVariant = product.variants[0]\n            const pricesContainer = self.find('.upsellItemPrices')\n            const modalContainer = $('#upsellItemModal').find(\n              '.upsellItemPrices'\n            )\n            createPrices(productVariant, pricesContainer)\n            createPrices(productVariant, modalContainer)\n          }\n        }\n      }\n      if (upsellSettings.upsellOnCheckout) {\n        const upsells = upsellSettings?.checkoutUpsells\n        $('body').append(`\n            <div id=\"modalOverlay\"></div>\n            <div id=\"checkoutUpsellModal\" class=\"upsellModal\">\n              <div id=\"checkoutUpsellModalContainer\">\n                <p class=\"checkoutSpsellModalSubhead\">Customize Your Order</p>\n                <h3>Add an Esqido Premium Lashes Kit at -40% OFF!</h3>\n                <div class=\"upsellHighlights\">\n                  <div class=\"upsellHighlightItem\">\n                    <img src=\"https://cdn.shopify.com/s/files/1/0250/1519/t/27/assets/time-icon.svg?v=1269636006768805444\" alt=\"\">\n                    <p>Highests Quality Materials That Lasts Up to 20-25 Wears</p>\n                  </div>\n                  <div class=\"upsellHighlightItem\">\n                    <img src=\"https://cdn.shopify.com/s/files/1/0250/1519/t/27/assets/eyelash-icon.svg?v=17637281597508357764\" alt=\"\">\n                    <p>Unisyn™ Technology Makes Them Ultra-natural Looking</p>\n                  </div>\n                  <div class=\"upsellHighlightItem\">\n                    <img src=\"https://cdn.shopify.com/s/files/1/0250/1519/t/27/assets/curler-icon.svg?v=18141781665275607000\" alt=\"\">\n                    <p>Recommended by A-list Celebs and Pro Make Up Artists</p>\n                  </div>\n                </div>\n                <div class=\"upsellItemListing\"></div>\n                <button id=\"skipCheckoutUpsell\" class=\"btn secondary\">No thanks, take me to checkout</button>\n                <button id=\"closeModal\">\n                  <img src=\"https://uploads-ssl.webflow.com/5e70f8e5d7461820999a0cf5/5e7b70d9dd8fc24bf01bc3be_close.svg\" alt=\"Close\" />\n                </button>\n              </div>\n            </div>\n          `)\n        if (upsells.length) {\n          const container = $('#checkoutUpsellModal').find('.upsellItemListing')\n          await upsells.map(async (item, i) => {\n            container.append(`\n                <div class=\"checkoutUpsellProduct product-${i}\">\n                </div>\n              `)\n            const productContainer = container.find(`.product-${i}`)\n            await fetchProduct(productContainer, item)\n            const product = productContainer.data('product')\n            productContainer.append(`\n                <div class=\"checkoutUpsellItemGalleryContainer\">\n                  <div class=\"checkoutUpsellItemGallery\"></div>\n                </div>\n                <p class=\"upsellItemTitle\">${product.title}</p>\n                <p class=\"upsellItemPrices\"></p>\n                <div class=\"upsellItemDescription\">${product.descriptionHtml}</div>\n                <button class=\"btn upsellAddToCart\" value=\"${product.variants[0].id}\">\n                  <img class=\"spinner\" src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n                  <span class=\"addToCartText\">Add & Checkout</span>\n                </button>\n              `)\n            const priceContainer = productContainer.find('.upsellItemPrices')\n            const galleryContainer = productContainer.find(\n              '.checkoutUpsellItemGallery'\n            )\n            $.each(product.images, function (i, img) {\n              $(galleryContainer).append(`\n                <img class=\"checkoutUpsellImage\" src=\"${img.src}\" alt=\"${img.altText}\">\n              `)\n            })\n            product.variants.map((variant) =>\n              createPrices(variant, priceContainer)\n            )\n          })\n        }\n      }\n      /*\n          Upsell Event Listeners \n        */\n      // Check when the variant option changes for the upsell in cart\n      $('#cart').on('change', '.upsellProductOption', function (e) {\n        const variant = recursiveArraySearch(\n          product.variants,\n          e.target.value\n        )[0]\n        const container = self.find('.upsellItemPrices').empty()\n        createPrices(variant, container)\n      })\n      // Check when the variant option changes for the upsell in modal\n      $('#upsellItemModal').on('change', '.upsellProductOption', function (e) {\n        const variant = recursiveArraySearch(\n          product.variants,\n          e.target.value\n        )[0]\n        const container = $('#upsellItemModal')\n          .find('.upsellItemPrices')\n          .empty()\n        if (upsellSettings?.discountCode) {\n          createPrices(variant, container)\n        } else {\n          createPrices(variant, container)\n        }\n      })\n      self.find('.upsellAddToCart').on('click', function (e) {\n        const selectedUpsell = self.find('.unit-option:selected')\n        const productVariant = self.data('optionsAndVariants')\n          ? selectedUpsell.val()\n          : self.data('product').variants[0].id\n        addUpsellItem(productVariant)\n        // Add event to FB\n        trackFbEvent(self, productVariant)\n        if (upsellSettings?.discountCode) {\n          addDiscountToCheckout(upsellSettings.discountCode)\n        }\n      })\n      // Listen for the selected upsell in the modal separately because it has its own dropdown\n      $('#upsellItemModal').on('click', '.upsellAddToCart', function (e) {\n        const selectedUpsell = $('#upsellItemModal').find(\n          '.unit-option:selected'\n        )\n        // If the product has variants, get the ID of the selected variant, otherwise just pass the first variant ID\n        const productVariant = self.data('optionsAndVariants')\n          ? selectedUpsell.val()\n          : self.data('product').variants[0].id\n        addUpsellItem(productVariant)\n        // Add event to FB\n        trackFbEvent(self, productVariant)\n        if (upsellSettings?.discountCode) {\n          addDiscountToCheckout(upsellSettings.discountCode)\n        }\n      })\n      $('body').on('click', '.upsellItemTitle, #closeModal', function (e) {\n        if (cartOpen) {\n          toggleCart()\n        } else if (modalOpen) {\n          toggleModal()\n        } else if (checkoutUpsellModalOpen) {\n          toggleCheckoutUpsellModal()\n        }\n      })\n      // Checkout Upsell event listeners\n      $('#checkoutUpsellModal').on('click', '.upsellAddToCart', async function (\n        e\n      ) {\n        await addUpsellItem(this.value)\n        await checkout()\n      })\n      $('#skipCheckoutUpsell').on('click', async function (e) {\n        await checkout()\n      })\n    }\n  }\n  /*\n      Helper Functions\n    */\n  const toggleModal = function () {\n    modalOpen = !modalOpen\n    $('body').toggleClass('modalOpen')\n    $('#upsellItemModal').fadeToggle()\n    if (modalOpen && slickInitCount === 0) {\n      $('.upsellItemGallery').slick({\n        arrows: true,\n        dots: true,\n      })\n      slickInitCount++\n    }\n  }\n  const toggleCheckoutUpsellModal = function () {\n    checkoutUpsellModalOpen = !checkoutUpsellModalOpen\n    $('body').toggleClass('modalOpen')\n    $('#checkoutUpsellModal').fadeToggle()\n    if (checkoutUpsellModalOpen && slickInitCount === 0) {\n      $('.checkoutUpsellItemGallery').slick({\n        arrows: true,\n        dots: true,\n      })\n      slickInitCount++\n    }\n  }\n  const persistToLocalStorage = function (key, value) {\n    let valueJson = JSON.stringify(value)\n    localStorage.setItem(key, valueJson)\n  }\n  const fetchFromLocalStorage = function (key) {\n    return JSON.parse(localStorage.getItem(key))\n  }\n  const extractLineItems = function (lineItems) {\n    if (lineItems?.length) {\n      const newLineItems = lineItems.map((item) => {\n        return {\n          title: item.title,\n          subtitle: item.variant.title,\n          ...item,\n        }\n      })\n      persistToLocalStorage(lsCartId, newLineItems)\n    } else {\n      persistToLocalStorage(lsCartId, [])\n    }\n  }\n  const setAddToCartLoading = function (boolean) {\n    const element = $('.addToCart').not(':contains(\"Sold Out\")')\n    if (element) {\n      if (boolean) {\n        element.attr('disabled', true)\n        element.find('.addToCartText').hide()\n        element.find('.spinner').show()\n      } else {\n        element.attr('disabled', false)\n        element.find('.spinner').hide()\n        element.find('.addToCartText').show()\n      }\n    }\n  }\n  const setCheckoutLoading = function (boolean) {\n    if (boolean) {\n      $('#checkoutButton').attr('disabled', true)\n      $('#checkoutButtonText').hide()\n      $('#checkoutButton .spinner').show()\n    } else {\n      $('#checkoutButton').attr('disabled', false)\n      $('#checkoutButton .spinner').hide()\n      $('#checkoutButtonText').show()\n    }\n  }\n  const toggleCart = function () {\n    cartOpen = !cartOpen\n    $('body').toggleClass('cartOpen')\n  }\n  const formatPrices = function (variant, formatToCurrency = true) {\n    let variantPrices = null\n    if (variant && variant?.presentmentPrices?.length) {\n      const results = variant.presentmentPrices.filter(\n        (item) => item.price.currencyCode === clientSettings.defaultCurrency\n      )\n      if (results?.length) {\n        variantPrices = results[0]\n      }\n    }\n    if (variantPrices) {\n      const { price, compareAtPrice } = variantPrices\n      let formattedPrice\n      let formattedComparePrice\n      // Formats prices currency format, supports multi-currency\n      const priceFormatter = new Intl.NumberFormat(\n        clientSettings.defaultRegion,\n        {\n          style: 'currency',\n          currency: clientSettings.defaultCurrency,\n          maximumSignificantDigits: 4, // Trim any zeros after decimal\n        }\n      )\n      if (formatToCurrency) {\n        if (price?.amount) {\n          formattedPrice = priceFormatter.format(price.amount)\n        }\n        if (compareAtPrice?.amount) {\n          formattedComparePrice = priceFormatter.format(compareAtPrice.amount)\n        }\n        return {\n          price: formattedPrice,\n          comparePrice: formattedComparePrice\n            ? formattedComparePrice\n            : formattedPrice,\n        }\n      } else {\n        return {\n          price: price?.amount,\n          comparePrice: compareAtPrice?.amount,\n        }\n      }\n    }\n  }\n  // Render product variant pricing\n  const createPrices = function (variant, container) {\n    if (variant && container) {\n      // If it's a single variant product\n      const singleVariant = variant.length === 1\n      const formattedPrices = formatPrices(variant)\n      const numericPrices = formatPrices(variant, false)\n      const discountType = upsellSettings?.discountType\n      const discountAmount = upsellSettings?.discountAmount\n      let productHandle\n      if (variant?.variableValues) {\n        productHandle = variant.variableValues.handle\n      } else if (variant?.product) {\n        productHandle = variant.product.handle\n      }\n      const priceFormatter = new Intl.NumberFormat(\n        clientSettings.defaultRegion,\n        {\n          style: 'currency',\n          currency: clientSettings.defaultCurrency,\n          maximumSignificantDigits: 4, // Trim any zeros after decimal\n        }\n      )\n      const isUpsellItem = productHandle === upsellSettings.cartUpsell\n      if (isUpsellItem && discountType) {\n        const { price, comparePrice } = numericPrices\n        const comparePriceFormatted = formattedPrices?.comparePrice\n        let discountPrice\n        if (discountType === 'percentage') {\n          if (comparePrice) {\n            discountPrice = comparePrice * (discountAmount / 100)\n          } else {\n            discountPrice = price * (discountAmount / 100)\n          }\n        } else if (discountType === 'fixed') {\n          if (comparePrice) {\n            discountPrice = comparePrice - discountAmount\n          } else {\n            discountPrice = price - discountAmount\n          }\n        }\n        const discountPriceFormatted = priceFormatter.format(discountPrice)\n        $(container).append(`\n            <p class=\"unit-price ${\n              singleVariant ? 'single-product-price' : ''\n            } ${discountPrice < price ? 'sale-price' : ''}\">${\n          discountPrice < price\n            ? \"<span class='unit-compare-price'>\" +\n              comparePriceFormatted +\n              '</span>'\n            : ''\n        }\n            ${discountPriceFormatted} ${\n          clientSettings.defaultCurrency === 'USD'\n            ? clientSettings.defaultCurrency\n            : ''\n        }\n            </p>\n          `)\n      } else {\n        const { price, comparePrice } = formattedPrices\n        if (formattedPrices) {\n          $(container).append(`\n          <p class=\"unit-price ${singleVariant ? 'single-product-price' : ''} ${\n            comparePrice > price ? 'sale-price' : ''\n          }\">${\n            comparePrice > price\n              ? \"<span class='unit-compare-price'>\" + comparePrice + '</span>'\n              : ''\n          }\n          ${price} ${\n            clientSettings.defaultCurrency === 'USD'\n              ? clientSettings.defaultCurrency\n              : ''\n          }\n          </p>\n        `)\n        }\n      }\n    }\n  }\n  const getOptionValues = function (product, name) {\n    if (product?.options) {\n      const productOptions = product.options.filter(\n        (option) => option.name.toLowerCase() === name\n      )\n      const values = productOptions[0]?.values.map((option) => option.value)\n      return values\n    }\n  }\n  const recursiveArraySearch = function (array, searchString) {\n    return array.filter(function search(row) {\n      return Object.keys(row).some((key) => {\n        if (typeof row[key] === 'string') {\n          return row[key].toLowerCase().indexOf(searchString.toLowerCase()) > -1\n        } else if (row[key] && typeof row[key] === 'object') {\n          return search(row[key])\n        }\n        return false\n      })\n    })\n  }\n  const fetchProduct = async function (container, productHandle) {\n    if (container && productHandle) {\n      const self = $(container)\n      // Render loading spinner\n      self.html(`\n      <div class=\"productSpinner\">\n        <img src=\"https://cdn.shopify.com/s/files/1/0250/1519/files/spinner.svg?v=1585762796\" alt=\"Loading Checkout\" />\n      </div>\n    `)\n      // Fetch product by product handle\n      await client.product\n        .fetchByHandle(productHandle)\n        .then((response) => {\n          const product = response\n          // Cache product data to memory\n          self.data('product', product)\n          // If product has unit and color options, save them to data\n          const unitOptions = getOptionValues(product, 'units')\n          const productOptions = product?.options\n            .filter((option) => option.name.toLowerCase() !== 'title')\n            .map((option) => option.name)\n          const colorOptions = getOptionValues(product, 'color')\n          const bundleOptions = getOptionValues(product, 'bundle')\n          const singleVariant = product?.variants?.length === 1\n          // Create a new array that contains the product variants grouped by unit options\n          let optionsAndVariants = []\n          if (unitOptions?.length) {\n            for (let index in unitOptions) {\n              let optionName = unitOptions[index]\n              let variants = recursiveArraySearch(product.variants, optionName)\n              optionsAndVariants.push({\n                name: optionName,\n                variants,\n              })\n            }\n          } else if (bundleOptions?.length) {\n            for (let index in bundleOptions) {\n              let optionName = bundleOptions[index]\n              let variants = recursiveArraySearch(product.variants, optionName)\n              optionsAndVariants.push({\n                name: optionName,\n                variants,\n              })\n            }\n          }\n          // Only cache them to data if the options exist\n          singleVariant && self.data('singleVariant', product?.variants[0])\n          productOptions?.length && self.data('productOptions', productOptions)\n          unitOptions?.length && self.data('unitOptions', unitOptions)\n          colorOptions?.length && self.data('colorOptions', colorOptions)\n          optionsAndVariants?.length &&\n            self.data('optionsAndVariants', optionsAndVariants)\n        })\n        .catch((error) => console.log(\"Couldn't fetch product: \", error))\n    }\n  }\n  const addUpsellItem = async function (variantId, qty = 1) {\n    // Reset the item count so it will rerender the cart from scratch\n    itemCount = 0\n    // Set loading states for buttons\n    setAddToCartLoading(true)\n    setCheckoutLoading(true)\n    const quantity = parseInt(qty, 10)\n    const itemsToAdd = [\n      {\n        variantId,\n        quantity,\n      },\n    ]\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    if (currentCheckoutId) {\n      await client.checkout\n        .addLineItems(currentCheckoutId, itemsToAdd)\n        .then(function (checkout) {\n          // Check to see if the item was added\n          if (checkout.lineItems.length) {\n            extractLineItems(checkout.lineItems)\n          }\n        })\n      // Set loading states for buttons to false\n      setAddToCartLoading(false)\n      setCheckoutLoading(false)\n      // Rerender cart\n      createCartItems()\n      if (modalOpen) {\n        toggleModal()\n      }\n      if (!cartOpen) {\n        toggleCart()\n      }\n    }\n  }\n  const addItems = async function (self, toggleElement) {\n    // Reset the item count so it will rerender the cart from scratch\n    itemCount = 0\n    // Set loading states for buttons\n    setAddToCartLoading(true)\n    setCheckoutLoading(true)\n    // Check if the cart has any items to add\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    let selectedVariantId\n    let selectedOption\n    // Check if the product is a single variant\n    const singleVariant = self.data('singleVariant')\n    if (singleVariant) {\n      selectedVariantId = singleVariant.id\n    } else {\n      // Get the current selected variant option and find the variant ID\n      selectedOption = self.find(\"input[type='radio']:checked\")\n      if (selectedOption?.length) {\n        selectedVariantId = selectedOption[selectedOption.length - 1]?.value\n      } else {\n        selectedVariantId = self.find('.upsellProductOption').val()\n      }\n    }\n    // Find the current specified quantity to add\n    const qty = parseInt(self.find('.qtySelector').val(), 10)\n    // Format the line items for passing into checkout api\n    const itemsToAdd = [\n      {\n        variantId: selectedVariantId,\n        quantity: qty ? qty : 1, // If there's no qtySelector set default to 1\n      },\n    ]\n    // Send event to FB\n    trackFbEvent(self, selectedVariantId)\n\n    if (currentCheckoutId) {\n      await client.checkout\n        .addLineItems(currentCheckoutId, itemsToAdd)\n        .then(function (checkout) {\n          // Check to see if the item was added\n          if (checkout.lineItems.length) {\n            extractLineItems(checkout.lineItems)\n          }\n        })\n        .catch((error) => console.log(\"Couldn't add item to checkout: \", error))\n      // Set loading states for buttons to false\n      setAddToCartLoading(false)\n      setCheckoutLoading(false)\n      // Rerender cart\n      createCartItems()\n      if (toggleElement === 'cart') {\n        toggleCart()\n      } else if (toggleElement === 'modal') {\n        toggleModal()\n        toggleCart()\n      }\n    }\n  }\n  const addDiscountToCheckout = async function (discountCode) {\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    if (discountCode) {\n      // Add a discount code to the checkout\n      await client.checkout\n        .addDiscount(currentCheckoutId, discountCode)\n        .then((checkout) => {})\n    }\n  }\n  const createCartItems = function () {\n    if (itemCount === 0) {\n      $('#cartLineItems').empty()\n    }\n    const cartItems = fetchFromLocalStorage(lsCartId)\n    // Render items in checkout in cart\n    if (cartItems?.length) {\n      $('#checkoutButton').show()\n      $('#cartEmpty').hide()\n      let priceCount = 0\n      // For each item in cartItems, render until they've all been rendered\n      for (itemCount; itemCount <= cartItems.length - 1; ) {\n        cartItems.map(function (item, i) {\n          const { variant } = item\n          const formattedPrices = formatPrices(variant)\n          const numericPrices = formatPrices(variant, false)\n          const { price } = numericPrices\n          const { comparePrice } = formattedPrices\n\n          $('#cartLineItems').append(`\n            <div class=\"cart-item\" data-value=\"${item.id}\">\n            ${\n              variant?.image?.src\n                ? `<img src=\"${variant.image.src}\" alt=\"${variant.image?.altText}\"/>`\n                : `<img src=\"https://uploads-ssl.webflow.com/5e70f8e5d7461820999a0cf5/5e83a3654bfbfa1aa178d629_placeholder.jpg\" alt=\"${item.title}\"/>`\n            }\n              <div class=\"cart-item-details\">\n                <p class=\"cart-item-title\">${item.title}</p>\n                ${\n                  // Don't show the variant title if it's a single variant product\n                  item.subtitle.toLowerCase().includes('default title')\n                    ? ''\n                    : `<p class='cart-item-subtitle'>${item.subtitle}</p>`\n                }\n                <p class=\"cart-item-price\" data-value=${variant.id}></p>\n                <div class=\"quantity\">\n                  <button class=\"quantity-button quantity-down\">-</button>\n                  <input class=\"qtySelector\" type=\"number\" min=\"0\" value=\"${\n                    item.quantity\n                  }\" data-value=\"${variant.id}\" />\n                  <button class=\"quantity-button quantity-up\">+</button>\n                </div>\n                <span class=\"cart-item-remove\" data-value=\"${\n                  item.id\n                }\">Remove</span>\n              </div>\n            </div>\n          `)\n          const priceContainer = $('#cartLineItems')\n            .find('.cart-item-price')\n            .val(variant.id)[i]\n          createPrices(variant, priceContainer)\n          // Increment the item count so we know we rendered all the items and won't fire on subsequent instances\n          itemCount++\n        })\n        const totalCartQty = cartItems.reduce((acc, item) => {\n          return acc + item.quantity\n        }, 0)\n        $('#cartCount').text(totalCartQty)\n      }\n    } else {\n      $('#cartEmpty').show()\n      $('#checkoutButton').hide()\n      $('#cartCount').text(0)\n    }\n  }\n  const removeItems = async function (variantId) {\n    // Reset the item count so it will rerender the cart from scratch\n    itemCount = 0\n    // Set loading states for buttons\n    setCheckoutLoading(true)\n    // Check if the cart has any items to add\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    const cartItems = fetchFromLocalStorage(lsCartId)\n    // Format the line items for passing into checkout api\n    const itemsToRemove = [variantId]\n    const matchingVariant = recursiveArraySearch(cartItems, variantId)[0]\n\n    await client.checkout\n      .removeLineItems(currentCheckoutId, itemsToRemove)\n      .then(function (checkout) {\n        extractLineItems(checkout.lineItems)\n      })\n      .catch((error) =>\n        console.log(\"Couldn't remove item from checkout: \", error)\n      )\n    if (matchingVariant && matchingVariant.id === variantId) {\n      await client.checkout\n        .removeDiscount(currentCheckoutId)\n        .then((checkout) => {})\n    }\n    // Set loading states for buttons to false\n    setCheckoutLoading(false)\n    // Rerender cart\n    createCartItems()\n  }\n  const updateItems = async function (variantId, qty) {\n    // Reset the item count so it will rerender the cart from scratch\n    itemCount = 0\n    // Set loading states for buttons\n    setAddToCartLoading(true)\n    setCheckoutLoading(true)\n    // Check if the cart has any items to add\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    // Get the current selected variant option and find the variant ID\n    // Format the line items for passing into checkout api\n    const itemsToUpdate = [\n      {\n        id: variantId,\n        quantity: qty,\n      },\n    ]\n    await client.checkout\n      .updateLineItems(currentCheckoutId, itemsToUpdate)\n      .then(function (checkout) {\n        extractLineItems(checkout.lineItems)\n      })\n      .catch((error) =>\n        console.log(\"Couldn't update items in checkout: \", error)\n      )\n    // Set loading states for buttons to false\n    setAddToCartLoading(false)\n    setCheckoutLoading(false)\n    // Rerender cart\n    createCartItems()\n  }\n  const checkout = async function () {\n    console.log('Checkout fired!')\n    const currentCheckoutId = fetchFromLocalStorage(lsCheckoutId)\n    const upsellDisplayCount = fetchFromLocalStorage(\n      lsCheckoutUpsellDisplayCount\n    )\n    // If the checkout upsell is not enabled, go to checkout directly\n    if (!upsellSettings.upsellOnCheckout) {\n      console.log('No checkout upsell')\n      setCheckoutLoading(true)\n      await client.checkout.fetch(currentCheckoutId).then((checkout) => {\n        // Do something with the checkout\n        if (checkout.webUrl) {\n          location.href = checkout.webUrl\n        }\n      })\n    } else {\n      // If the upsell hasn't been shown to the customer yet, trigger the modal\n      if (upsellDisplayCount === 0) {\n        console.log('Count:', upsellDisplayCount)\n        toggleCart()\n        toggleCheckoutUpsellModal()\n        checkoutUpsellDisplayCount++\n        persistToLocalStorage(\n          lsCheckoutUpsellDisplayCount,\n          checkoutUpsellDisplayCount\n        )\n      } else {\n        console.log('checking out')\n        // If the upsell has already been shown, skip the modal and go to checkout\n        setCheckoutLoading(true)\n        await client.checkout.fetch(currentCheckoutId).then((checkout) => {\n          // Do something with the checkout\n          if (checkout.webUrl) {\n            location.href = checkout.webUrl\n          }\n        })\n      }\n    }\n  }\n  const trackFbEvent = function (self, variantId) {\n    // Add Facebook Tracking\n    const productTitle = self.data('product')?.title\n    const productVariant = recursiveArraySearch(\n      self.data('product').variants,\n      variantId\n    )[0]\n    const pattern = /\\/([0-9]+)[^\\/]*$/\n    const productVariantShopifyId = pattern.exec(\n      atob(self.data('product')?.id)\n    )[1]\n    const qty = parseInt(self.find('.qtySelector').val(), 10)\n    if (typeof fbq !== 'undefined') {\n      fbq('track', 'AddToCart', {\n        value: parseInt(productVariant.priceV2.amount, 10),\n        currency: clientSettings.defaultCurrency,\n        content_type: 'product_group',\n        content_ids: productVariantShopifyId,\n        content_category: productVariant.title,\n        content_name: productVariant.title,\n        num_items: qty ? qty : 1,\n      })\n    }\n  }\n})(jQuery)\n","// extracted by mini-css-extract-plugin"],"sourceRoot":""}